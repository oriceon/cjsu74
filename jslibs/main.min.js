if("serviceWorker"in navigator){console.log("CLIENT: service worker registration in progress.");navigator.serviceWorker.register("/sw.js").then((function(){console.log("CLIENT: service worker registration complete.")}),(function(){console.log("CLIENT: service worker registration failure.")}))}else{console.log("CLIENT: service worker is not supported.")}let formData={};let positions={nume:[56.808,39.195],prenume:[119.267,39.195],data_nastere_ziua:[56.42,48.206],data_nastere_luna:[71.501,48.206],data_nastere_an:[86.582,48.206],adresa_linia_1:[56.102,57.217],adresa_linia_2:[56.102,66.228],adresa_deplasare:[19.995,94.821],motivul_deplasarii_1:[32.409,122.811+.692],motivul_deplasarii_2:[32.409,132.606+.692],motivul_deplasarii_3:[32.409,137.814+.692],motivul_deplasarii_4:[32.409,142.881+.692],motivul_deplasarii_5:[32.409,147.974+.692],motivul_deplasarii_6:[32.409,158.237+.692],motivul_deplasarii_7:[32.409,163.554+.692],motivul_deplasarii_8:[32.409,168.974+.692],motivul_deplasarii_9:[32.409,183.925+.692],motivul_deplasarii_10:[32.409,193.7+.692],motivul_deplasarii_11:[32.409,203.599+.692],today:[57,250],semnatura:[130,247]};function getMobileOperatingSystem(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;if(/windows phone/i.test(userAgent)){return"Windows Phone"}if(/android/i.test(userAgent)){return"Android"}if(/iPad|iPhone|iPod/.test(userAgent)&&!window.MSStream){return"iOS"}return"unknown"}let mobileOS=getMobileOperatingSystem();$((function(){let generatePdfBtn=$("#generatePdfBtn");let loadingDiv=$("#loading-container");let declaratieForm=$("#declaratie");let signatureBlackboard=$("#signature-container");let signatureBlackboardReset=$("#signature-reset");let signatureHolographic=$("#signature");let androidIndicator=$("#android-downloads-indicator");signatureHolographic.jSignature();signatureBlackboardReset.click((function(e){signatureHolographic.jSignature("reset")}));declaratieForm.submit((function(e){e.preventDefault();generatePdfBtn.prop("disabled",true);loadingDiv.removeClass("d-none");var sData=declaratieForm.find(":input").not("#semnatura").serializeArray();signatureVector=signatureHolographic.jSignature("getData");var today=(new Date).toJSON().slice(0,10).split("-").reverse().join(".");var doc=new jsPDF("p","mm","a4",true);doc.addFileToVFS("Merriweather_Regular.ttf",Merriweather_Regular);doc.addFont("Merriweather_Regular.ttf","Merriweather_Regular","normal");doc.setFont("Merriweather_Regular");doc.setFontSize(11);doc.addImage(background,"PNG",0,0,210,297);for(var field in sData){if(typeof positions[sData[field].name]!=="undefined"){if(sData[field].value=="check"){doc.circle(positions[sData[field].name][0]+1.5,positions[sData[field].name][1]+1.5,2,"F")}else{doc.text(positions[sData[field].name][0]+1,positions[sData[field].name][1]+5,sData[field].value)}formData[sData[field].name]=sData[field].value}}var semnatura_info=doc.getImageProperties(signatureVector);var ratio=semnatura_info.width/semnatura_info.height;var height=17;var width=height*ratio;doc.addImage(signatureVector,"PNG",positions["semnatura"][0],positions["semnatura"][1]+10-height,width,height);doc.text(positions["today"][0],positions["today"][1],today);var docname="DECLARAȚIE PE PROPRIE RĂSPUNDERE cf. Hotărâre CNSSU nr.24 din /14.05.2020, "+formData.nume+" "+formData.prenume+", "+today+".pdf";doc.save(docname,{returnPromise:true}).then(setTimeout((function(){loadingDiv.addClass("d-none");generatePdfBtn.prop("disabled",false);if(mobileOS=="Android"){androidIndicator.removeClass("d-none");setTimeout((function(){androidIndicator.addClass("d-none")}),5e3)}}),700))}))}));
